---
title: Integra√ß√£o Langfuse
description: Saiba como integrar o Langfuse ao CrewAI via OpenTelemetry usando OpenLit
icon: vials
---

# Integre o Langfuse ao CrewAI

Este notebook demonstra como integrar o **Langfuse** ao **CrewAI** usando OpenTelemetry via o SDK **OpenLit**. Ao final deste notebook, voc√™ ser√° capaz de rastrear suas aplica√ß√µes CrewAI com o Langfuse para melhorar a observabilidade e a depura√ß√£o.

> **O que √© Langfuse?** [Langfuse](https://langfuse.com) √© uma plataforma open-source de engenharia LLM. Ela fornece recursos de rastreamento e monitoramento para aplica√ß√µes LLM, ajudando desenvolvedores a depurar, analisar e otimizar seus sistemas de IA. O Langfuse se integra com v√°rias ferramentas e frameworks atrav√©s de integra√ß√µes nativas, OpenTelemetry e APIs/SDKs.

[![V√≠deo de Vis√£o Geral do Langfuse](https://github.com/user-attachments/assets/3926b288-ff61-4b95-8aa1-45d041c70866)](https://langfuse.com/watch-demo)

## Primeiros Passos

Vamos passar por um exemplo simples usando CrewAI e integrando ao Langfuse via OpenTelemetry utilizando o OpenLit.

### Passo 1: Instale as Depend√™ncias

```python
%pip install langfuse openlit crewai crewai_tools
```

### Passo 2: Configure as Vari√°veis de Ambiente

Defina suas chaves de API do Langfuse e configure as op√ß√µes de exporta√ß√£o do OpenTelemetry para enviar os traces ao Langfuse. Consulte a [Documenta√ß√£o Langfuse OpenTelemetry](https://langfuse.com/docs/opentelemetry/get-started) para mais informa√ß√µes sobre o endpoint Langfuse OpenTelemetry `/api/public/otel` e autentica√ß√£o.

```python
import os
 
# Obtenha as chaves do seu projeto na p√°gina de configura√ß√µes do projeto: https://cloud.langfuse.com
os.environ["LANGFUSE_PUBLIC_KEY"] = "pk-lf-..." 
os.environ["LANGFUSE_SECRET_KEY"] = "sk-lf-..."
os.environ["LANGFUSE_HOST"] = "https://cloud.langfuse.com" # üá™üá∫ Regi√£o UE
# os.environ["LANGFUSE_HOST"] = "https://us.cloud.langfuse.com" # üá∫üá∏ Regi√£o EUA
 
 
# Sua chave OpenAI
os.environ["OPENAI_API_KEY"] = "sk-proj-..."
```
Com as vari√°veis de ambiente configuradas, agora podemos inicializar o cliente Langfuse. A fun√ß√£o get_client() inicializa o cliente Langfuse usando as credenciais fornecidas nas vari√°veis de ambiente.

```python
from langfuse import get_client
 
langfuse = get_client()
 
# Verificar conex√£o
if langfuse.auth_check():
    print("Cliente Langfuse autenticado e pronto!")
else:
    print("Falha na autentica√ß√£o. Verifique suas credenciais e host.")
```

### Passo 3: Inicialize o OpenLit

Inicialize o SDK de instrumenta√ß√£o OpenTelemetry do OpenLit para come√ßar a capturar traces do OpenTelemetry.

```python
import openlit

openlit.init()
```

### Passo 4: Crie uma Aplica√ß√£o Simples CrewAI

Vamos criar uma aplica√ß√£o simples CrewAI onde m√∫ltiplos agentes colaboram para responder √† pergunta de um usu√°rio.

```python
from crewai import Agent, Task, Crew

from crewai_tools import (
    WebsiteSearchTool
)

web_rag_tool = WebsiteSearchTool()

writer = Agent(
        role="Writer",
        goal="Voc√™ torna a matem√°tica envolvente e compreens√≠vel para crian√ßas pequenas atrav√©s de poesias",
        backstory="Voc√™ √© especialista em escrever haicais mas n√£o sabe nada de matem√°tica.",
        tools=[web_rag_tool],  
    )

task = Task(description=("O que √© {multiplica√ß√£o}?"),
            expected_output=("Componha um haicai que inclua a resposta."),
            agent=writer)

crew = Crew(
  agents=[writer],
  tasks=[task],
  share_crew=False
)
```

### Passo 5: Veja os Traces no Langfuse

Ap√≥s rodar o agente, voc√™ pode visualizar os traces gerados pela sua aplica√ß√£o CrewAI no [Langfuse](https://cloud.langfuse.com). Voc√™ ver√° etapas detalhadas das intera√ß√µes do LLM, o que pode ajudar na depura√ß√£o e otimiza√ß√£o do seu agente de IA.

![Exemplo de trace CrewAI no Langfuse](https://langfuse.com/images/cookbook/integration_crewai/crewai-example-trace.png)

_[Exemplo p√∫blico de trace no Langfuse](https://cloud.langfuse.com/project/cloramnkj0002jz088vzn1ja4/traces/e2cf380ffc8d47d28da98f136140642b?timestamp=2025-02-05T15%3A12%3A02.717Z&observation=3b32338ee6a5d9af)_

## Refer√™ncias

- [Documenta√ß√£o Langfuse OpenTelemetry](https://langfuse.com/docs/opentelemetry/get-started)