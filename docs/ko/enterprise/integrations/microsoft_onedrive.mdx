---
title: Microsoft OneDrive 통합
description: "CrewAI를 위한 Microsoft OneDrive 통합으로 파일 및 폴더 관리."
icon: "cloud"
mode: "wide"
---

## 개요

에이전트가 Microsoft OneDrive에서 파일과 폴더를 업로드, 다운로드 및 관리할 수 있도록 합니다. AI 기반 자동화로 파일 작업을 자동화하고, 콘텐츠를 구성하고, 공유 링크를 생성하며, 클라우드 스토리지 워크플로를 간소화합니다.

## 전제 조건

Microsoft OneDrive 통합을 사용하기 전에 다음 사항을 확인하세요:

- 활성 구독이 있는 [CrewAI AMP](https://app.crewai.com) 계정
- OneDrive 액세스 권한이 있는 Microsoft 계정
- [통합 페이지](https://app.crewai.com/crewai_plus/connectors)를 통해 Microsoft 계정 연결

## Microsoft OneDrive 통합 설정

### 1. Microsoft 계정 연결

1. [CrewAI AMP 통합](https://app.crewai.com/crewai_plus/connectors)으로 이동
2. 인증 통합 섹션에서 **Microsoft OneDrive** 찾기
3. **연결**을 클릭하고 OAuth 플로우 완료
4. 파일 액세스에 필요한 권한 부여
5. [통합 설정](https://app.crewai.com/crewai_plus/settings/integrations)에서 Enterprise Token 복사

### 2. 필요한 패키지 설치

```bash
uv add crewai-tools
```

## 사용 가능한 작업

<AccordionGroup>
  <Accordion title="microsoft_onedrive/list_files">
    **설명:** OneDrive의 파일과 폴더를 나열합니다.

    **매개변수:**
    - `top` (integer, 선택사항): 검색할 항목 수 (최대 1000). 기본값: 50.
    - `orderby` (string, 선택사항): 필드별 정렬 (예: "name asc", "lastModifiedDateTime desc"). 기본값: "name asc".
    - `filter` (string, 선택사항): OData 필터 표현식.
  </Accordion>

  <Accordion title="microsoft_onedrive/get_file_info">
    **설명:** 특정 파일 또는 폴더에 대한 정보를 가져옵니다.

    **매개변수:**
    - `item_id` (string, 필수): 파일 또는 폴더의 ID.
  </Accordion>

  <Accordion title="microsoft_onedrive/download_file">
    **설명:** OneDrive에서 파일을 다운로드합니다.

    **매개변수:**
    - `item_id` (string, 필수): 다운로드할 파일의 ID.
  </Accordion>

  <Accordion title="microsoft_onedrive/upload_file">
    **설명:** OneDrive에 파일을 업로드합니다.

    **매개변수:**
    - `file_name` (string, 필수): 업로드할 파일의 이름.
    - `content` (string, 필수): Base64로 인코딩된 파일 내용.
  </Accordion>

  <Accordion title="microsoft_onedrive/create_folder">
    **설명:** OneDrive에 새 폴더를 만듭니다.

    **매개변수:**
    - `folder_name` (string, 필수): 만들 폴더의 이름.
  </Accordion>

  <Accordion title="microsoft_onedrive/delete_item">
    **설명:** OneDrive에서 파일 또는 폴더를 삭제합니다.

    **매개변수:**
    - `item_id` (string, 필수): 삭제할 파일 또는 폴더의 ID.
  </Accordion>

  <Accordion title="microsoft_onedrive/copy_item">
    **설명:** OneDrive에서 파일 또는 폴더를 복사합니다.

    **매개변수:**
    - `item_id` (string, 필수): 복사할 파일 또는 폴더의 ID.
    - `parent_id` (string, 선택사항): 대상 폴더의 ID (선택사항, 기본값은 루트).
    - `new_name` (string, 선택사항): 복사된 항목의 새 이름 (선택사항).
  </Accordion>

  <Accordion title="microsoft_onedrive/move_item">
    **설명:** OneDrive에서 파일 또는 폴더를 이동합니다.

    **매개변수:**
    - `item_id` (string, 필수): 이동할 파일 또는 폴더의 ID.
    - `parent_id` (string, 필수): 대상 폴더의 ID.
    - `new_name` (string, 선택사항): 항목의 새 이름 (선택사항).
  </Accordion>

  <Accordion title="microsoft_onedrive/search_files">
    **설명:** OneDrive에서 파일과 폴더를 검색합니다.

    **매개변수:**
    - `query` (string, 필수): 검색 쿼리 문자열.
    - `top` (integer, 선택사항): 반환할 결과 수 (최대 1000). 기본값: 50.
  </Accordion>

  <Accordion title="microsoft_onedrive/share_item">
    **설명:** 파일 또는 폴더의 공유 링크를 만듭니다.

    **매개변수:**
    - `item_id` (string, 필수): 공유할 파일 또는 폴더의 ID.
    - `type` (string, 선택사항): 공유 링크 유형. 옵션: view, edit, embed. 기본값: view.
    - `scope` (string, 선택사항): 공유 링크 범위. 옵션: anonymous, organization. 기본값: anonymous.
  </Accordion>

  <Accordion title="microsoft_onedrive/get_thumbnails">
    **설명:** 파일의 썸네일을 가져옵니다.

    **매개변수:**
    - `item_id` (string, 필수): 파일의 ID.
  </Accordion>
</AccordionGroup>

## 사용 예제

### 기본 Microsoft OneDrive 에이전트 설정

```python
from crewai import Agent, Task, Crew

# Microsoft OneDrive 기능을 가진 에이전트 생성
onedrive_agent = Agent(
    role="파일 관리자",
    goal="OneDrive에서 파일과 폴더를 효율적으로 관리",
    backstory="Microsoft OneDrive 파일 작업 및 구성 전문 AI 어시스턴트.",
    apps=['microsoft_onedrive']  # 모든 OneDrive 작업을 사용할 수 있습니다
)

# 파일 나열 및 폴더 생성 작업
organize_files_task = Task(
    description="OneDrive 루트 디렉토리의 모든 파일을 나열하고 '프로젝트 문서'라는 새 폴더를 만드세요.",
    agent=onedrive_agent,
    expected_output="파일 목록이 표시되고 새 폴더 '프로젝트 문서'가 생성됨."
)

# 작업 실행
crew = Crew(
    agents=[onedrive_agent],
    tasks=[organize_files_task]
)

crew.kickoff()
```

## 문제 해결

### 일반적인 문제

**인증 오류**
- Microsoft 계정이 파일 액세스에 필요한 권한을 가지고 있는지 확인하세요 (예: `Files.Read`, `Files.ReadWrite`).
- OAuth 연결이 필요한 모든 범위를 포함하는지 확인하세요.

**파일 업로드 문제**
- 파일 업로드 시 `file_name`과 `content`가 제공되는지 확인하세요.
- 바이너리 파일의 경우 내용이 Base64로 인코딩되어야 합니다.

### 도움 받기

<Card title="도움이 필요하신가요?" icon="headset" href="mailto:support@crewai.com">
  Microsoft OneDrive 통합 설정 또는 문제 해결에 대한 지원이 필요하시면 지원팀에 문의하세요.
</Card>
